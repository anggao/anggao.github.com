<!doctype html><html lang=en><head><meta name=generator content="Hugo 0.74.3"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>Ang's Blog</title><meta name=Description content="Ang's Blog"><meta property="og:title" content="Ang's Blog"><meta property="og:description" content="Ang's Blog"><meta property="og:type" content="website"><meta property="og:url" content="http://anggao.github.io/"><meta property="og:image" content="http://anggao.github.io/logo.png"><meta property="og:updated_time" content="2020-07-29T12:59:24+01:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://anggao.github.io/logo.png"><meta name=twitter:title content="Ang's Blog"><meta name=twitter:description content="Ang's Blog"><meta name=application-name content="Ang's Blog"><meta name=apple-mobile-web-app-title content="Ang's Blog"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=http://anggao.github.io/><link rel=alternate href=/index.xml type=application/rss+xml title="Ang's Blog"><link rel=feed href=/index.xml type=application/rss+xml title="Ang's Blog"><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"WebSite","url":"http:\/\/anggao.github.io\/","inLanguage":"en","author":{"@type":"Person","name":"Ang"},"description":"Ang's Blog","image":"http:\/\/anggao.github.io\/images\/Apple-Devices-Preview.png","thumbnailUrl":"http:\/\/anggao.github.io\/images\/screenshot.png","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","name":"Ang's Blog"}</script><script data-ad-client=ca-pub-2343695267074726 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':('auto'==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:'auto'==='dark'))&&document.body.setAttribute('theme','dark');</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Ang's Blog"><span class=header-title-pre><i class="far fa-kiss-wink-heart fa-fw"></i></span>Ang's Blog</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=/about/>About </a><a class=menu-item href=https://github.com/anggao title=GitHub rel="noopener noreffer" target=_blank><i class="fab fa-github fa-fw"></i></a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Ang's Blog"><span class=header-title-pre><i class="far fa-kiss-wink-heart fa-fw"></i></span>Ang's Blog</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/>Posts</a><a class=menu-item href=/tags/>Tags</a><a class=menu-item href=/categories/>Categories</a><a class=menu-item href=/about/>About</a><a class=menu-item href=https://github.com/anggao title=GitHub rel="noopener noreffer" target=_blank><i class="fab fa-github fa-fw"></i></a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class="page home" posts><div class=home-profile><div class=home-avatar><a href=/posts/ title=Posts><img class=lazyload src=/svg/loading.min.svg data-src="https://www.gravatar.com/avatar/f819a092b23cb25a09f87436f68df217?s=240&d=mp" data-srcset="https://www.gravatar.com/avatar/f819a092b23cb25a09f87436f68df217?s=240&d=mp, https://www.gravatar.com/avatar/f819a092b23cb25a09f87436f68df217?s=240&d=mp 1.5x, https://www.gravatar.com/avatar/f819a092b23cb25a09f87436f68df217?s=240&d=mp 2x" data-sizes=auto alt="https://www.gravatar.com/avatar/f819a092b23cb25a09f87436f68df217?s=240&d=mp" title="https://www.gravatar.com/avatar/f819a092b23cb25a09f87436f68df217?s=240&d=mp"></a></div><h1 class=home-title>Ang Gao</h1><h2 class=home-subtitle>Software Engineer @ TripAdvisor, CS Ph.D @ University College Cork</h2><div class=links><a href=https://github.com/anggao title=GitHub target=_blank rel="noopener noreffer me"><i class="fab fa-github-alt fa-fw"></i></a><a href=https://twitter.com/anggao title=Twitter target=_blank rel="noopener noreffer me"><i class="fab fa-twitter fa-fw"></i></a><a href=/index.xml title=RSS target=_blank rel="noopener noreffer me"><i class="fas fa-rss fa-fw"></i></a></div></div><article class="single summary" itemscope itemtype=http://schema.org/Article><h1 class=single-title itemprop="name headline"><a href=/2020-07-29-service-mesh01/>Service Mesh01</a></h1><div class=post-meta><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>Ang</a></span>&nbsp;<span class=post-publish>published on <time datetime=2020-07-29>2020-07-29</time></span></div><div class=content>微服务架构的特性 围绕业务构建团队 Conway&rsquo;s Law Any organization that designs a system (defined broadly) will produce a design whose structure is a copy of the organization&rsquo;s communication structure. 去中心化的数据管理 Fallacies of distributed computing The network is reliable; Latency is zero; Bandwidth is infinite; The network is secure; Topology doesn&rsquo;t change;</div><div class=post-footer><a href=/2020-07-29-service-mesh01/>Read More</a></div></article><article class="single summary" itemscope itemtype=http://schema.org/Article><h1 class=single-title itemprop="name headline"><a href=/2020-02-01-kind-cluster/>Setup Kubernetes Cluster with Kind</a></h1><div class=post-meta><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>Ang</a></span>&nbsp;<span class=post-publish>published on <time datetime=2020-02-01>2020-02-01</time></span></div><div class=content>Intro kind is a tool for running local Kubernetes clusters using Docker container “nodes”. kind was primarily designed for testing Kubernetes itself, but may be used for local development or CI.
Setup Golang development Install Go tools. Follow docs. Config $GOROOT and $GOPATH $GOROOT is for compiler/tools that comes from go installation. This should be configured to the go directory that was installed. $GOPATH is for your own go projects / 3rd party libraries (downloaded with &ldquo;go get&rdquo;).</div><div class=post-footer><a href=/2020-02-01-kind-cluster/>Read More</a><div class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/k8s/>k8s</a></div></div></article><article class="single summary" itemscope itemtype=http://schema.org/Article><h1 class=single-title itemprop="name headline"><a href=/hugo/>Basic Markdown Syntax</a></h1><div class=post-meta><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>Ang</a></span>&nbsp;<span class=post-publish>published on <time datetime=2019-12-01>2019-12-01</time></span>&nbsp;<span class=post-category>included in <a href=/categories/markdown/><i class="far fa-folder fa-fw"></i>Markdown</a></span></div><div class=content><p>This article offers a sample of basic Markdown syntax that can be used in Hugo content files.</p></div><div class=post-footer><a href=/hugo/>Read More</a><div class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/markdown/>Markdown</a>,&nbsp;<a href=/tags/html/>HTML</a></div></div></article><article class="single summary" itemscope itemtype=http://schema.org/Article><h1 class=single-title itemprop="name headline"><a href=/2020-03-01-kind-cluster-xfs/>Kind Cluster issue</a></h1><div class=post-meta><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>Ang</a></span>&nbsp;<span class=post-publish>published on <time datetime=2019-02-21>2019-02-21</time></span></div><div class=content>To use Kind cluster you need to have overlay(2) storage driver with Docker if you are using XFS filesystem.
overlayfs-driver https://docs.docker.com/storage/storagedriver/overlayfs-driver/
The overlay and overlay2 drivers are supported on xfs backing filesystems, but only with d_type=true enabled.
1 2 3 4 5 6 7 8 9 10 11 xfs_info / meta-data=/dev/mapper/centos_agao isize=512 agcount=4, agsize=3276800 blks = sectsz=512 attr=2, projid32bit=1 = crc=1 finobt=0 spinodes=0 data = bsize=4096 blocks=13107200, imaxpct=25 = sunit=0 swidth=0 blks naming =version 2 bsize=4096 ascii-ci=0 ftype=1 log =internal bsize=4096 blocks=6400, version=2 = sectsz=512 sunit=0 blks, lazy-count=1 realtime =none extsz=4096 blocks=0, rtextents=0 The 3rd column of the 6th line of the xfs_info output is the most interesting because it contains the parameter ftype which should be 1.</div><div class=post-footer><a href=/2020-03-01-kind-cluster-xfs/>Read More</a><div class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/k8s/>k8s</a></div></div></article><article class="single summary" itemscope itemtype=http://schema.org/Article><h1 class=single-title itemprop="name headline"><a href=/2019-02-20-k8s-05/>Kubernetes Note 05</a></h1><div class=post-meta><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>Ang</a></span>&nbsp;<span class=post-publish>published on <time datetime=2019-02-20>2019-02-20</time></span></div><div class=content>对于一个 Deployment 所管理的 Pod，它的 ownerReference 是 ReplicaSet ReplicaSet 负责通过控制器模式，保证系统中 Pod 的个数永远等于指定的个数 Deployment 只允许容器的 restartPolicy=Always 水平扩展 $ kubectl scale deployment nginx-deployment --replicas=4 滚动更新 R</div><div class=post-footer><a href=/2019-02-20-k8s-05/>Read More</a><div class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/k8s/>k8s</a></div></div></article><article class="single summary" itemscope itemtype=http://schema.org/Article><h1 class=single-title itemprop="name headline"><a href=/2019-02-18-k8s-04/>Kubernetes Note 04</a></h1><div class=post-meta><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>Ang</a></span>&nbsp;<span class=post-publish>published on <time datetime=2019-02-18>2019-02-18</time></span></div><div class=content>容器健康检查和恢复机制 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 apiVersion:v1kind:Podmetadata:labels:test:livenessname:test-liveness-execspec:containers:- name:livenessimage:busyboxargs:- /bin/sh- -c- touch/tmp/healthy;sleep30;rm-rf/tmp/healthy;sleep600livenessProbe:exec:command:- cat- /tmp/healthyinitialDelaySeconds:5periodSeconds:5 Pod 的恢复过程，永远都是发生在当前节点上，而不会跑到别的节点上去</div><div class=post-footer><a href=/2019-02-18-k8s-04/>Read More</a><div class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/k8s/>k8s</a></div></div></article><ul class=pagination><li class="page-item active"><span class=page-link><a href=/>1</a></span></li><li class=page-item><span class=page-link><a href=/page/2/>2</a></span></li><li class=page-item><span class=page-link><a href=/page/3/>3</a></span></li><li class=page-item><span class=page-link aria-hidden=true>&mldr;</span></li><li class=page-item><span class=page-link><a href=/page/11/>11</a></span></li></ul></div></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.74.3">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i>LoveIt</a></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2013 - 2020</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>Ang</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i></a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript>window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10}};</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js',new Date());gtag('config','UA-34162724-1',{'anonymize_ip':true});</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=UA-34162724-1" async></script></body></html>